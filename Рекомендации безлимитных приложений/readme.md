# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±–µ–∑–ª–∏–º–∏—Ç–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π SQL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±–µ–∑–ª–∏–º–∏—Ç–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –æ–ø—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ç—Ä–∞—Ñ–∏–∫–∞ –∞–±–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö.

## üìä –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –Ω–∞–±–æ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:

| –ü–æ–ª–µ | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –û–ø–∏—Å–∞–Ω–∏–µ |
| ---- | ---------- | -------- |
| account_id | UInt64 | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–∞–∫–∫–∞—É–Ω—Ç–∞ |
| amount | Decimal | –°—É–º–º–∞ —Ç–µ–∫—É—â–µ–π –ø–ª–∞—Ç–µ–∂–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| interval_start | DateTime | –ù–∞—á–∞–ª–æ 24-—á–∞—Å–æ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (–≤—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏ - 24 —á–∞—Å–∞) |
| interval_end | DateTime | –ö–æ–Ω–µ—Ü –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (–≤—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏) |
| interval_amount | Decimal | –ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π –∑–∞ 24-—á–∞—Å–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª |
| interval_count | UInt64 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞ 24-—á–∞—Å–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª |

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ –∞–Ω–∞–ª–∏–∑–∞**  
   –ó–∞–¥–∞—ë—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –ø–∞–∫–µ—Ç–∞ (`packet_start_date`) –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö –¥–Ω–µ–π (`passed_days`).

2. **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É –≤ —Ä–∞–º–∫–∞—Ö –æ–ø—Ü–∏–π** (`traffic_by_option`)  
   - –°–æ–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ç—Ä–∞—Ñ–∏–∫–µ (`data_traffic`) —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö (`packet`).
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏ –ø–æ –¥–∞—Ç–µ –∏ –Ω–µ–Ω—É–ª–µ–≤–æ–º—É –ª–∏–º–∏—Ç—É.
   - –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ –∞–±–æ–Ω–µ–Ω—Ç—É, –æ–ø—Ü–∏–∏ –∏ –ª–∏–º–∏—Ç—É, —Å—É–º–º–∏—Ä—É—è —Ç—Ä–∞—Ñ–∏–∫ (–≤ –ú–ë).

3. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–∏–±–æ–ª–µ–µ –∑–∞—Ç—Ä–∞—Ç–Ω–æ–π –æ–ø—Ü–∏–∏** (`top_option`)  
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–±–æ–Ω–µ–Ω—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç –æ–ø—Ü–∏—é —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º —Ç—Ä–∞—Ñ–∏–∫–∞.
   - –ò—Å–∫–ª—é—á–∞–µ—Ç –∑–∞–ø–∏—Å–∏ —Å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –æ–ø—Ü–∏–µ–π (`'Unknown'`).

4. **–†–∞—Å—á—ë—Ç —Å—É–º–º–∞—Ä–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∞** (`traffic_total_by_account`)  
   - –°—É–º–º–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –ø–æ –≤—Å–µ–º –æ–ø—Ü–∏—è–º –∞–±–æ–Ω–µ–Ω—Ç–∞.
   - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ—Ç –º–µ—Å—è—á–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –¥–Ω–µ–≤–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.
   - –í—ã—á–∏—Å–ª—è–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–∞ (`ratio`).


5. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π**  
   - –û—Ç–±–∏—Ä–∞–µ—Ç –∞–±–æ–Ω–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç (`ratio > 1`).
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç ID –∞–±–æ–Ω–µ–Ω—Ç–∞ –∏ –Ω–∞–∏–±–æ–ª–µ–µ –∑–∞—Ç—Ä–∞—Ç–Ω—É—é –æ–ø—Ü–∏—é –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –±–µ–∑–ª–∏–º–∏—Ç–∞.

## –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- `packet_start_date` ‚Äî –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `'2024-09-01'`).
- `passed_days` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `10`).

## –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- `account_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–±–æ–Ω–µ–Ω—Ç–∞.
- `top_option_by_spend_mb` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ü–∏–∏ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º —Ç—Ä–∞—Ñ–∏–∫–∞.
